<!DOCTYPE html>
<html>
  <head>
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
  </head>
  <body>
    %%[
    VAR @origin, @pattern, @match
    SET @origin = HTTPRequestHeader("Referer")
    SET @pattern = "^(http:\/\/(.*\.)?((wizsolucoes)\.com.br))($|\/)"
    SET @match = RegExMatch(@origin, @pattern, 1)
]%%
    
     <script runat=server>
      Platform.Load("core","1");
      var MATCH = Variable.GetValue("@match");
      if (!MATCH) { MATCH = null }
      HTTPHeader.SetValue("Access-Control-Allow-Methods","POST");
      HTTPHeader.SetValue("Access-Control-Allow-Origin",MATCH);
      Platform.Response.SetResponseHeader("Strict-Transport-Security","max-age=200"); 
      Platform.Response.SetResponseHeader("X-XSS-Protection","1; mode=block"); 
      Platform.Response.SetResponseHeader("X-Frame-Options","Deny"); 
      Platform.Response.SetResponseHeader("X-Content-Type-Options","nosniff"); 
      Platform.Response.SetResponseHeader("Referrer-Policy","strict-origin-when-cross-origin"); 
      Platform.Response.SetResponseHeader("Content-Security-Policy","default-src 'self'");
    </script>
    %%[

VAR @Satisfaction, @Reason, @id
    
    IF LENGTH(@match) > 0 THEN  
    SET @Satisfaction = RequestParameter("satisfaction")
    SET @Reason = RequestParameter("reason")
    SET @id = RequestParameter("id")

    IF @Satisfaction >= 0 THEN
        UpdateSingleSalesforceObject(
          "Case",@id,
          "NPS__c",@Satisfaction
        )
    ENDIF
ENDIF
]%%
   
  </body>
</html>
