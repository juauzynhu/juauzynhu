<!DOCTYPE html>
<html>
  <head>
    <title>Amptest fx</title>
  </head>
  <body> %%[
    VAR @Satisfaction, @Reason, @id 
        SET @Satisfaction = RequestParameter('satisfaction')
        SET @Reason = RequestParameter('reason')
        SET @id = RequestParameter('id')
    ]%%
    %%=v(@Satisfaction)=%%<br>
    %%=v(@Reason)=%% <br>
    %%=v(@id)=%%


<script runat="server">

    Platform.Load("core", "1.1.1");

    var referer = String(Platform.Request.ReferrerURL).split("?")[0];

    try {
      
    var updateSFObject = "UpdateSingleSalesforceObject('Case', @id, 'NPS__c', @Satisfaction)";
    var results = Platform.Function.TreatAsContent(updateSFObject);


 
        
    } catch (err) {

      referer += "?error=1&message=" + Stringify(err.message) + Stringify(err.description);
      Platform.Response.Redirect(referer);

    } finally {

      Platform.Response.Redirect(referer + "?ok=1");
      
    }
</script>
        </body>
</html>
